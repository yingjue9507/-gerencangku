# 心流AI多窗网页浏览器 - 开发需求文档

## 项目概述
心流AI多窗网页浏览器是一个基于Electron的桌面应用程序，支持多窗口浏览、AI集成等功能。

## 功能需求列表

### 1. 启动脚本优化 ✅
**需求描述：** 解决批处理文件编码问题和控制台乱码问题
**实现状态：** 已完成
**实现日期：** 2024年12月

**详细说明：**
- 修复了批处理文件的编码问题，解决双击后立即退出的问题
- 将应用内所有中文日志改为英文，解决Windows控制台乱码问题
- 创建了多种启动方式：
  - `启动.bat` - 标准启动脚本
  - `启动-调试版.bat` - 包含调试信息的启动脚本
  - `启动.ps1` - PowerShell启动脚本
  - `安装依赖.bat` - 依赖检查和安装脚本

**技术实现：**
- 重新创建批处理文件，使用英文提示信息
- 修改 `src/main/main.js` 中的所有 `console.log` 输出为英文
- 添加错误处理和调试信息
- 支持UTF-8编码显示

**用户体验改进：**
- 启动时显示清晰的英文日志信息
- 解决了控制台乱码问题
- 提供多种启动方式满足不同用户需求
- 增强了错误提示和调试信息

### 2. 多窗口管理功能 ✅
**需求描述：** 支持多窗口浏览和窗口管理
**实现状态：** 已完成

**功能特性：**
- 主窗口创建和管理
- 弹出窗口自动管理
- 窗口缩放功能（Ctrl+鼠标滚轮）
- 窗口自动收回功能
- OAuth弹窗特殊处理

### 3. 会话管理功能 ✅
**需求描述：** 支持独立的浏览会话管理
**实现状态：** 已完成

**功能特性：**
- 分区会话管理
- 会话数据清理
- Cookie和缓存管理
- 独立的浏览环境

## 已完成功能需求

### 4. AI服务管理增强 ✅
**需求描述：** 改进服务删除功能UI，新增中国常用AI服务，实现用户高度自由的服务管理
**实现状态：** 已完成
**实现日期：** 2024年12月

**详细说明：**
- 改进右键菜单删除选项的视觉效果，使用红色高亮显示
- 增强删除确认对话框，提供更详细的警告信息
- 添加错误处理和成功通知机制
- 新增5个中国常用AI服务：通义千问、文心一言、豆包、Kimi、智谱清言
- **重要变更**：允许删除所有服务，包括默认AI服务，移除删除限制

**技术实现：**
- 修改右键菜单样式，删除选项使用红色背景和白色文字
- 优化删除确认对话框的文案和样式
- 完善错误处理机制和用户反馈
- 扩展AI服务配置，支持更多国内AI平台
- 移除对默认服务的删除保护，实现完全自由的服务管理

**用户体验改进：**
- 更直观的删除操作体验，减少误操作
- 支持更多中国本土AI服务，满足国内用户需求
- 更好的错误处理和用户反馈
- **完全自由的服务管理**：用户可删除任何服务，拥有完全控制权

### 5. UI界面优化 ✅
**需求描述：** 优化应用界面的视觉效果和用户体验
**实现状态：** 已完成
**实现日期：** 2024年12月

**详细说明：**
- 将AI应用设置的背景颜色改为浅蓝色系渐变
- 提升界面的视觉舒适度和现代感
- 保持与整体设计风格的一致性

**技术实现：**
- 修改 `index.html` 中的 `body` 样式
- 使用CSS渐变背景：`linear-gradient(135deg, #e3f2fd 0%, #bbdefb 50%, #90caf9 100%)`
- 从原有的紫色系渐变更新为清新的浅蓝色系

**用户体验改进：**
- 更加清新舒适的视觉体验
- 减少视觉疲劳，提升长时间使用的舒适度
- 符合现代应用设计趋势

### 6. 无痕模式功能 ✅
**需求描述：** 为AI服务增加无痕模式，关闭后自动删除所有浏览和登录痕迹
**实现状态：** 已完成
**实现日期：** 2024年12月

**详细说明：**
- 在添加和编辑AI服务时提供无痕模式选项
- 无痕模式下使用临时分区，不保存任何浏览数据
- 关闭服务时自动清理所有会话数据和登录信息
- 提供清晰的用户反馈和状态提示

**技术实现：**
- 在服务配置中添加 `incognitoMode` 布尔字段
- 修改 `webview` 创建逻辑，无痕模式使用临时分区ID
- 实现 `clearIncognitoData` 方法清理会话数据
- 支持清理cookies、localStorage、缓存等所有浏览痕迹
- 在关闭时显示数据清理状态通知

**功能特性：**
- **临时分区**：无痕模式使用 `incognito-${serviceId}-${timestamp}` 格式的临时分区
- **数据隔离**：与普通模式完全隔离，不影响其他服务
- **自动清理**：关闭时自动清理所有存储数据（cookies、localStorage、缓存等）
- **用户反馈**：清晰的状态提示和操作反馈
- **安全性**：确保无痕模式下的数据不会泄露或保留

**用户体验改进：**
- 提供隐私保护选项，满足用户对数据安全的需求
- 简单易用的开关设计，用户可自由选择
- 清晰的状态反馈，用户了解数据清理状态
- 支持临时使用AI服务而不留下任何痕迹

## 待开发功能

### 5. AI集成功能
**需求描述：** 集成AI助手功能
**优先级：** 高
**预期功能：**
- AI对话界面
- 网页内容AI分析
- 智能搜索建议
- AI辅助浏览

### 5. 书签管理
**需求描述：** 完善的书签管理系统
**优先级：** 中
**预期功能：**
- 书签添加/删除/编辑
- 书签分类管理
- 书签导入/导出
- 书签同步

### 6. 历史记录
**需求描述：** 浏览历史记录管理
**优先级：** 中
**预期功能：**
- 历史记录查看
- 历史记录搜索
- 历史记录清理
- 访问频率统计

### 7. 扩展支持
**需求描述：** 支持浏览器扩展
**优先级：** 低
**预期功能：**
- 扩展安装/卸载
- 扩展管理界面
- 常用扩展预装
- 扩展权限管理

## 技术架构

### 主要技术栈
- **前端框架：** Electron
- **主进程：** Node.js
- **渲染进程：** HTML/CSS/JavaScript
- **包管理：** npm

### 项目结构
```
src/
├── main/           # 主进程代码
│   └── main.js     # 主进程入口文件
├── renderer/       # 渲染进程代码
│   └── index.html  # 主界面
└── adapters/       # 适配器模块
```

## 版本历史

### v1.2.0 (2024年12月)
- **新增功能**：
  - UI界面优化：将应用背景改为清新的浅蓝色系渐变
  - 无痕模式功能：为AI服务增加隐私保护选项
- **功能特性**：
  - 无痕模式使用临时分区，关闭后自动清理所有浏览痕迹
  - 支持cookies、localStorage、缓存等全面数据清理
  - 提供清晰的状态反馈和操作提示
- **用户体验提升**：
  - 更舒适的视觉体验，减少长时间使用的疲劳
  - 增强隐私保护，满足用户对数据安全的需求
  - 简单易用的无痕模式开关设计

### v1.1.1 (2024年12月)
- **重要功能变更**：移除默认服务删除限制，实现用户高度自由管理
- **服务管理自由化**：所有AI服务（包括默认服务）均可删除
- **用户体验提升**：用户拥有完全的服务管理控制权
- **代码优化**：简化删除逻辑，移除服务类型判断限制

### v1.1.0 (2024年12月)
- **新增功能**:
  - 改进AI服务删除功能UI，使用红色高亮显示删除选项
  - 增强删除确认对话框，提供详细警告信息和错误处理
  - 新增5个中国常用AI服务：通义千问、文心一言、豆包、Kimi、智谱清言
- **用户体验优化**:
  - 更直观的删除操作体验，减少误操作风险
  - 支持更多中国本土AI服务，满足国内用户需求
  - 完善的错误处理和用户反馈机制

### v1.0.0 (当前版本)
- 基础多窗口浏览功能
- 启动脚本优化
- 会话管理功能
- 窗口管理功能

## 开发规范

### 代码规范
- 使用英文注释和日志信息
- 遵循JavaScript ES6+标准
- 统一的错误处理机制
- 完善的日志记录

### 文档规范
- 每个新功能都需要更新此需求文档
- 保持README.md和使用说明.txt的同步更新
- 记录重要的技术决策和实现细节

---
*最后更新：2024年12月*